extends index

mixin iter-options(listy)
  each thing in listy
    +id-slug-option(thing)

mixin id-slug-option({id, title})
    label(for=title)
    option(value=id)=title

block content
  h1=title
  br
  div
    div(class="card card-compact w-full bg-base-100 shadow-xl")
      div(class="card-body")
        h2(class="card-title") Create/Edit Gallery 
        form(action="/admin/gallery" method="post" enctype="application/json")
          div(class="form-control w-full max-w-xs")
            select(
              name="galleryId"
              class="select select-primary w-full max-w-xs" 
              hx-get="/admin/single"
              hx-target="#gallery-data"
            )
              option(value="" selected) -- New Gallery --
              label(for="New Gallery")
              +iter-options(galleries)
          br
          div(id="gallery-data")
            label(for="title")
              span(class="label-text") Title: 
              div(id="gallery-title")
                input(
                name="title" 
                type="text" 
                class="input input-bordered w-full"
              )
            br
            label(for="description")
              span(class="label-text") Description:
              div(id="gallery-description")
                input(
                  name="description" 
                  type="text" 
                  class="input input-bordered w-full"
                )
            br
            input(class="btn btn-primary" type="submit" value="Create") 
    br
    br
    div(class="card card-compact w-full bg-base-100 shadow-xl")
      div(class="card-body")
        h2(class="card-title") Create/Edit Page
        form(action="/admin/page", method="post", enctype="application/json")
          div(class="form-control w-full max-w-xs")
            select(
              name="pageId"
              class="select select-primary w-full max-w-xs"
              hx-get="/admin/singlepage"
              hx-target="#page-data"
              )
              option(value="" selected) -- New Page --
              +iter-options(pages)
            br
            div(id="page-data")
              label(for="title")
                span(class="label-text") Title:
                div(id="page-title")
                  input(
                    name="title"
                    type="text"
                    class="input input-bordered w-full"
                  )
          br
          input(class="btn btn-primary" type="submit")
    br
    br
    div(class="card card-compact w-full bg-base-100 shadow-xl")
      div(class="card-body")
        h2(class="card-title") Photo Upload
        form(action="/admin/photo", method="post", enctype="multipart/form-data")
          div(class="form-control w-full max-w-xs")
            label(for="target") Location: 
            select(
              name="target"
              class="select select-primary w-full max-w-xs"
            )
              option(value="" selected) -- No Target --
              optgroup(label="Galleries" )
                +iter-options(galleries)
              optgroup(label="Pages")
                +iter-options(pages)
          br
          label(for="photos")
            span(class="label-text") Photo(s):
            div(id="photos")
              input(
                name="photos" 
                type="file" 
                class="file-input file-input-bordered file-input-primary w-full max-w-xs"
                multiple="multiple" 
                accept="image/*" 
                required="required"
              )
          br
          input(class="btn btn-primary" type="submit")

block append scripts
  script(src="https://unpkg.com/htmx.org/dist/ext/json-enc.js" async) 